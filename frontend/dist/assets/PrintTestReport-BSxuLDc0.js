import{j as t}from"./index-D_CM1r6M.js";const b=(i,m={})=>{if(!i)return null;let n=i;i instanceof Map&&(n=Object.fromEntries(i));const s=m?.gender?.toLowerCase();if(m){if(m.isPregnant){if(n["Pregnant Female"])return n["Pregnant Female"];if(n["Pregnant(borderline Gestational age)"])return n["Pregnant(borderline Gestational age)"]}if(m.age){const d=parseInt(m.age);if(!isNaN(d)){if(d<1&&n["New Born"])return n["New Born"];if(d<18&&n.Children)return n.Children;if(d>=65&&n.Elderly)return n.Elderly;if(d>=18&&n.Adult)return n.Adult;if(d>=18&&n.Adults)return n.Adults}}if(s){if(n[s])return n[s];if(n[s.charAt(0).toUpperCase()+s.slice(1)])return n[s.charAt(0).toUpperCase()+s.slice(1)];if(n.feMale)return n.feMale}}if(n.Normal)return n.Normal;if(n.Negative)return n.Negative;const u=Object.keys(n)[0];return u?n[u]:null},D=(i,m,n={})=>{if(!m||i===void 0||i===null||i==="")return null;const s=b(m,n);if(!s)return null;const u=parseFloat(i);if(isNaN(u))return null;let d,g;return typeof s.min=="string"?d=parseFloat(s.min):d=s.min,typeof s.max=="string"?g=parseFloat(s.max):g=s.max,d===void 0||g===void 0||isNaN(d)||isNaN(g)?null:u>=d&&u<=g},E=(i,m={})=>{if(!i)return"Range not defined";const n=b(i,m);if(!n){const d=i instanceof Map?Object.fromEntries(i):i,g=Object.entries(d).filter(([j,p])=>p&&(p.min!==void 0||p.max!==void 0)).map(([j,p])=>{const C=p.min!==void 0?p.min:"N/A",N=p.max!==void 0?p.max:"N/A";return`${j}: ${C} - ${N}`});return g.length>0?g.join(" | "):"No ranges available"}const s=n.min!==void 0?n.min:"N/A",u=n.max!==void 0?n.max:"N/A";return`${s} - ${u}`},F=(i,m={})=>{if(!i)return"Custom";const n=b(i,m);if(!n)return"Multiple ranges";const s=i instanceof Map?Object.fromEntries(i):i;for(const[u,d]of Object.entries(s))if(d===n||d&&d.min===n.min&&d.max===n.max)return u;return"Selected range"},_=["68834cbea01362dc885e9043","68835847a01362dc885e90cb","6883540ca01362dc885e9081"],B=i=>{if(!i)return!1;const m=String(i).trim();return _.some(n=>String(n).trim()===m)},O=({patientTest:i,testDefinitions:m})=>{const n=(r,l="")=>!r||r==="Nill"||r==="NIL"||r==="nil"||r.trim()===""?"":r,s={...i.patient_Detail,gender:i.patient_Detail?.patient_Gender,age:i.patient_Detail?.patient_Age,isPregnant:i.patient_Detail?.isPregnant},u=r=>{if(!r)return"N/A";try{const l=new Date(r);if(isNaN(l.getTime()))return"N/A";const o={timeZone:"Asia/Karachi",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1},c=new Intl.DateTimeFormat("en-PK",o).formatToParts(l),x=c.find(h=>h.type==="day").value,y=c.find(h=>h.type==="month").value,A=c.find(h=>h.type==="year").value,w=c.find(h=>h.type==="hour").value,f=c.find(h=>h.type==="minute").value;return`${x}-${y}-${A} ${w}:${f}`}catch{return"N/A"}},d=()=>{const r=new Date,l={timeZone:"Asia/Karachi",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1},a=new Intl.DateTimeFormat("en-PK",l).formatToParts(r),c=a.find(f=>f.type==="day").value,x=a.find(f=>f.type==="month").value,y=a.find(f=>f.type==="year").value,A=a.find(f=>f.type==="hour").value,w=a.find(f=>f.type==="minute").value;return`${c}-${x}-${y} ${A}:${w}`},g=r=>{if(!r)return"N/A";const l=r.match(/(\d+) years (\d+) months (\d+) days/);return l?`(${l[1]})Y, (${l[2]})M, (${l[3]})D`:r},j=(r,l)=>{if(!r.normalRange||Object.keys(r.normalRange).length===0)return"";const o=b(r.normalRange,l);if(!o)return"";const a=o.min!==void 0&&o.min!=="Nill"&&o.min!=="Nil"?o.min:"",c=o.max;return!a&&!c?"":a?c?`${a} - ${c}`:a:c},p=(r,l,o)=>{if(!r.normalRange||!l)return!1;const a=b(r.normalRange,o);if(!a)return!1;const c=parseFloat(l);if(isNaN(c))return!1;const x=typeof a.min=="string"?parseFloat(a.min):a.min,y=typeof a.max=="string"?parseFloat(a.max):a.max;return isNaN(x)||isNaN(y)?!1:c<x||c>y},C=()=>{const r=[],l=[];return m.forEach(o=>{const a=o.testId;B(a)?r.push({...o,_printId:a}):l.push({...o,_printId:a})}),{separatePageTests:r,groupedTests:l}},{separatePageTests:N,groupedTests:T}=C(),$=(r=>{const l=[];for(let o=0;o<r.length;o+=2)l.push(r.slice(o,o+2));return l})(T),v=()=>t.jsxs("div",{style:e.patientInfoSection,children:[t.jsx("div",{style:e.legalNotice,children:"Not valid for court"}),t.jsx("table",{style:e.patientInfoTable,children:t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("td",{style:e.labelCell,children:"Lab #"}),t.jsx("td",{style:e.valueCell,children:n(s.patient_MRNo)}),t.jsx("td",{style:e.labelCell,children:"Sample Date"}),t.jsx("td",{style:e.valueCell,children:u(i.createdAt)})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e.labelCell,children:"Patient Name"}),t.jsx("td",{style:e.valueCell,children:n(s.patient_Name)}),t.jsx("td",{style:e.labelCell,children:"Referred By"}),t.jsx("td",{style:e.valueCell,children:n(i.patient_Detail.referredBy)})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e.labelCell,children:"Gender"}),t.jsx("td",{style:e.valueCell,children:n(s.patient_Gender)}),t.jsx("td",{style:e.labelCell,children:"Patient Age"}),t.jsx("td",{style:e.valueCell,children:g(s.patient_Age)})]}),t.jsxs("tr",{children:[t.jsx("td",{style:e.labelCell,children:"Contact #"}),t.jsx("td",{style:e.valueCell,children:n(s.patient_ContactNo)}),t.jsx("td",{style:e.labelCell,children:"Report Date"}),t.jsx("td",{style:e.valueCell,children:d()})]})]})})]}),P=(r,l,o=!1)=>t.jsxs("div",{children:[t.jsxs("div",{style:e.testSection,children:[t.jsx("div",{style:e.testTitle,children:r.testName}),t.jsxs("table",{style:e.testTable,children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{style:{...e.tableHeader,...e.testNameHeader},children:"Test Name"}),t.jsx("th",{style:{...e.tableHeader,...e.resultHeader},children:"Result"}),t.jsx("th",{style:{...e.tableHeader,...e.unitHeader},children:"Unit"}),t.jsx("th",{style:{...e.tableHeader,...e.rangeHeader},children:"Reference Range"})]})}),t.jsx("tbody",{children:r.fields&&r.fields.map((a,c)=>{const x=j(a,s);return t.jsxs("tr",{children:[t.jsx("td",{style:{...e.tableCell,...e.testNameCell},children:a.fieldName||a.name}),t.jsx("td",{style:p(a,a.value,s)?{...e.tableCell,...e.resultCell,...e.abnormal}:{...e.tableCell,...e.resultCell},children:n(a.value)||"  "}),t.jsx("td",{style:{...e.tableCell,...e.unitCell},children:n(a.unit)}),t.jsx("td",{style:{...e.tableCell,...e.rangeCell},children:x})]},c)})})]})]}),o&&t.jsx("div",{style:e.testDivider})]},l),S=(r,l,o=!1)=>t.jsxs("div",{className:o?"separate-page-test":"grouped-test",style:o?{...e.pageContainer,...e.separatePage}:e.pageContainer,children:[t.jsx("div",{style:e.letterheadSpace}),t.jsxs("div",{style:e.contentArea,children:[v(),P(r,l,!1)]})]},l),I=(r,l)=>r.length===0?null:t.jsxs("div",{className:"grouped-tests-page",style:e.pageContainer,children:[t.jsx("div",{style:e.letterheadSpace}),t.jsxs("div",{style:e.contentArea,children:[v(),r.map((o,a)=>P(o,a,a<r.length-1))]})]},l);return t.jsxs("div",{style:e.mainContainer,children:[N.map((r,l)=>S(r,l,!0)),$.map((r,l)=>I(r,l)),m.length===0&&t.jsxs("div",{style:e.pageContainer,children:[t.jsx("div",{style:e.letterheadSpace}),t.jsxs("div",{style:e.contentArea,children:[v(),t.jsx("div",{style:e.noTestsMessage,children:"No test results to display"})]})]})]})},e={mainContainer:{width:"210mm",margin:"0 auto"},pageContainer:{width:"210mm",minHeight:"297mm",position:"relative",pageBreakInside:"avoid",backgroundColor:"#fff"},separatePage:{pageBreakAfter:"always",pageBreakBefore:"always"},letterheadSpace:{height:"60mm",backgroundColor:"transparent"},contentArea:{padding:"0 10mm",minHeight:"223mm"},patientInfoSection:{marginBottom:"8mm"},legalNotice:{textAlign:"right",marginBottom:"4mm",fontSize:"10pt",color:"#666"},patientInfoTable:{width:"100%",borderCollapse:"collapse",marginBottom:"4mm",fontSize:"11pt"},labelCell:{fontWeight:"bold",width:"20%",padding:"3px 6px",border:"1px solid #ddd",backgroundColor:"#f5f5f5"},valueCell:{padding:"3px 6px",border:"1px solid #ddd",width:"30%"},testSection:{marginBottom:"4mm"},testDivider:{height:"10mm",margin:"6mm 0",border:"none",borderRadius:"1mm"},testTitle:{fontWeight:"bold",fontSize:"13pt",marginBottom:"3mm",color:"#eaeff5ff",backgroundColor:"#47484bff",padding:"2px 0",borderBottom:"2px solid #bfc9d3ff"},testTable:{width:"100%",borderCollapse:"collapse",marginBottom:"2mm",tableLayout:"fixed",fontSize:"10pt"},tableHeader:{backgroundColor:"#f0f0f0",border:"1px solid #ddd",padding:"4px 6px",textAlign:"left",fontWeight:"bold"},tableCell:{border:"1px solid #ddd",padding:"4px 6px",verticalAlign:"top",lineHeight:"1.2"},noTestsMessage:{textAlign:"center",padding:"20mm",color:"#666",fontSize:"14pt"},testNameHeader:{width:"40%"},resultHeader:{width:"20%"},unitHeader:{width:"15%"},rangeHeader:{width:"25%"},testNameCell:{width:"40%",wordWrap:"break-word"},resultCell:{width:"20%",wordWrap:"break-word"},unitCell:{width:"15%",wordWrap:"break-word"},rangeCell:{width:"25%",wordWrap:"break-word",whiteSpace:"normal"},abnormal:{color:"red",fontWeight:"bold"}};export{O as P,E as f,F as g,D as i};
