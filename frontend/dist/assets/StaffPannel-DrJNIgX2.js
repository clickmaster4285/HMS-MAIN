import{e as j,j as e,f as T,d as _,u as D,r as p,J as b,aZ as y,a_ as E,y as N,a$ as O}from"./index-D_CM1r6M.js";import{N as R,O as L,P as M,t as F,v as $,Q as q}from"./index-jLjFIv2f.js";import{P as f}from"./index-DKThCUkT.js";import{r as z}from"./index-DzhyyO-l.js";import{g as w}from"./getRoleRoute-Do-Qfut4.js";import"./iconBase-DSUUJbys.js";const P=({data:a,columns:n,loading:c=!1,emptyMessage:d="No data found",onRowClick:m,className:x=""})=>{const[t,h]=j.useState({key:null,direction:"ascending"}),i=j.useMemo(()=>t.key?[...a].sort((r,o)=>r[t.key]<o[t.key]?t.direction==="ascending"?-1:1:r[t.key]>o[t.key]?t.direction==="ascending"?1:-1:0):a,[a,t]),g=r=>{let o="ascending";t.key===r&&t.direction==="ascending"&&(o="descending"),h({key:r,direction:o})},l=r=>t.key!==r?e.jsx(R,{className:"ml-1 opacity-30"}):t.direction==="ascending"?e.jsx(L,{className:"ml-1"}):e.jsx(M,{className:"ml-1"});return e.jsx("div",{className:`overflow-x-auto bg-white rounded-lg shadow ${x}`,children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:n.map(r=>e.jsx("th",{scope:"col",className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider ${r.sortable?"cursor-pointer hover:bg-gray-100":""}`,onClick:()=>r.sortable&&g(r.field),children:e.jsxs("div",{className:"flex items-center",children:[r.header,r.sortable&&l(r.field)]})},r.field))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c?e.jsx("tr",{children:e.jsx("td",{colSpan:n.length,className:"px-6 py-4 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"})})})}):i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:n.length,className:"px-6 py-4 text-center text-gray-500",children:d})}):i.map((r,o)=>e.jsx("tr",{className:`hover:bg-gray-50 ${m?"cursor-pointer":""}`,onClick:()=>m&&m(r),children:n.map((u,v)=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.render?u.render(r):e.jsx("div",{className:"text-sm text-gray-900",children:r[u.field]})},v))},o))})]})})},C=({tabs:a,activeTab:n,onTabChange:c})=>e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex -mb-px",children:a.map(d=>e.jsx("button",{onClick:()=>c(d.id),className:`whitespace-nowrap py-4 px-6 border-b-2 font-medium text-sm ${n===d.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:d.label},d.id))})});C.propTypes={tabs:f.arrayOf(f.shape({id:f.string.isRequired,label:f.string.isRequired})).isRequired,activeTab:f.string.isRequired,onTabChange:f.func.isRequired};const I=({isOpen:a=!1,onClose:n,title:c,children:d,size:m="md",closeOnOverlayClick:x=!0})=>{if(!a)return null;const t={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl",full:"max-w-full"},h=i=>{i.target===i.currentTarget&&x&&n()};return z.createPortal(e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-white/30 backdrop-blur-lg",onClick:h,children:e.jsxs("div",{className:`w-full ${t[m]} bg-white rounded-lg shadow-xl overflow-hidden`,children:[c&&e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:c}),e.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-500",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4",children:d})]})}),document.body)},W=()=>{const a=T(),n=_(),{staffList:c,deletedStaffList:d,loading:m,error:x}=D(s=>s.staff),[t,h]=p.useState(""),[i,g]=p.useState("active"),[l,r]=p.useState({isOpen:!1,message:"",onConfirm:null});p.useEffect(()=>{a(i==="active"?b():y())},[a,i]);const o=s=>{r({isOpen:!0,message:"Are you sure you want to delete this staff member?",onConfirm:async()=>{try{await a(E(s)),a(b())}catch{N.error("Failed to delete staff")}r({...l,isOpen:!1})}})},u=s=>{r({isOpen:!0,message:"Are you sure you want to restore this staff member?",onConfirm:async()=>{try{await a(O(s)),a(y())}catch{N.error("Failed to restore staff")}r({...l,isOpen:!1})}})},v=s=>{n(w(`staff/edit/${s}`))},S=()=>{n(w("staff/new"))},k=(i==="active"?c:d).filter(s=>s.user?.user_Name?.toLowerCase().includes(t.toLowerCase())||s.user?.user_Contact?.includes(t)||s.user?.user_Email&&s.user.user_Email.toLowerCase().includes(t.toLowerCase())),A=[{field:"userid",header:"User Id",render:s=>s.user?.user_Identifier||"N/A"},{field:"name",header:"Name",render:s=>s.user?.user_Name||"N/A"},{field:"email",header:"Email",render:s=>s.user?.user_Email||"N/A"},{field:"phone",header:"Phone",render:s=>s.user?.user_Contact||"N/A"},{field:"department",header:"Department",render:s=>s.department||"N/A"},{field:"designation",header:"Designation",render:s=>s.designation||"N/A"},{field:"role",header:"Role",render:s=>s.user?.user_Access||"N/A"},{field:"actions",header:"Actions",render:s=>e.jsx("div",{className:"flex space-x-4",children:i==="active"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>v(s._id),className:"text-primary-600 hover:text-primary-800",title:"Edit",children:e.jsx(F,{size:18})}),e.jsx("button",{onClick:()=>o(s._id),className:"text-red-600 hover:text-red-800",title:"Delete",children:e.jsx($,{size:18})})]}):e.jsx("button",{onClick:()=>u(s._id),className:"text-green-600 hover:text-green-800",title:"Restore",children:e.jsx(q,{size:18})})})}];return m?e.jsx("div",{children:"Loading..."}):x?e.jsxs("div",{children:["Error: ",x]}):e.jsxs("div",{className:"container mx-auto",children:[e.jsx("div",{className:"bg-primary-600 rounded-md text-white px-6 py-8 mb-6 shadow-md",children:e.jsx("div",{className:"max-w-9xl mx-auto",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-12 w-1 bg-primary-300 mr-4 rounded-full"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Staff Management"}),e.jsx("p",{className:"text-primary-100 mt-1",children:i==="active"?"Manage all active staff members":"View and restore deleted staff members"})]})]}),i==="active"&&e.jsxs("button",{onClick:S,className:"px-4 py-2 bg-white text-primary-600 rounded-md hover:bg-primary-50 transition-colors duration-200 font-medium flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})}),e.jsx("span",{children:"Add New Staff"})]})]})})}),e.jsx(C,{tabs:[{id:"active",label:"Active Staff"},{id:"deleted",label:"Deleted Staff"}],activeTab:i,onTabChange:g}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:`Search ${i==="active"?"active":"deleted"} staff...`,className:"w-full p-2 border rounded",value:t,onChange:s=>h(s.target.value)})}),e.jsx(P,{data:k,columns:A,loading:m,emptyMessage:`No ${i==="active"?"active":"deleted"} staff members found`}),e.jsxs(I,{isOpen:l.isOpen,title:"Confirm Action",onClose:()=>r({...l,isOpen:!1}),children:[e.jsx("p",{className:"mb-4",children:l.message}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{onClick:()=>r({...l,isOpen:!1}),className:"px-4 py-2 border rounded hover:bg-gray-100",children:"Cancel"}),e.jsx("button",{onClick:l.onConfirm,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Confirm"})]})]})]})};export{W as default};
