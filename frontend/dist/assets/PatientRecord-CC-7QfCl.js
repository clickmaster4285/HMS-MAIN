import{f as R,d as A,r as n,u as L,b7 as S,j as e}from"./index-D_CM1r6M.js";import{a1 as k,q as I,m as P,A as F,c as E,s as M}from"./index-jLjFIv2f.js";import{m as O,n as $}from"./index-CVhLpNpZ.js";import{g as U}from"./getRoleRoute-Do-Qfut4.js";import{D as B}from"./DateRangePicker-SV5E2ldF.js";import"./iconBase-DSUUJbys.js";const T=void 0,Z=()=>{const t=R(),i=A(),[r,g]=n.useState({start:new Date,end:new Date}),{currentDoctor:s,patients:m,status:p,error:N}=L(a=>a.doctor),[l,j]=n.useState(""),[d,f]=n.useState("all"),o=JSON.parse(localStorage.getItem("user")).doctorProfile._id;n.useEffect(()=>{o&&t(S(o))},[o,t]);const h=m?.filter(a=>{try{const x=new Date(a.createdAt),y=new Date(r.start),w=new Date(r.end),u=new Date(x.toDateString()),v=new Date(y.toDateString()),b=new Date(w.toDateString()),D=u>=v&&u<=b,_=a.patient_Name?.toLowerCase().includes(l.toLowerCase())||a.patient_MRNo?.toLowerCase().includes(l.toLowerCase())||a.patient_ContactNo?.toLowerCase().includes(l.toLowerCase())||a.patient_CNIC?.toLowerCase().includes(l.toLowerCase()),C=d==="all"||d==="recent"&&new Date(a.createdAt)>new Date(Date.now()-10080*60*1e3);return D&&_&&C}catch(x){return console.error("Error filtering patient:",x),!1}})||[];return p==="loading"?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):p==="failed"?e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-700",children:N})})]})}):e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-6",children:[e.jsx("div",{className:"bg-linear-to-r from-primary-500 to-primary-700 p-4 text-white",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-4",children:e.jsx("img",{src:s?.doctor_Image?.filePath?`${T}${s.doctor_Image.filePath}`:`https://ui-avatars.com/api/?name=${encodeURIComponent(s?.user?.user_Name||"D")}&background=random`,alt:s?.user?.user_Name,className:"w-16 h-16 rounded-full object-cover border-4 border-white shadow",onError:a=>{a.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(s?.user?.user_Name||"D")}&background=random`}})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:s?.user?.user_Name}),e.jsxs("p",{className:"text-primary-100",children:[s?.doctor_Department," â€¢ ",s?.doctor_Specialization]}),e.jsx("div",{className:"flex items-center mt-1",children:e.jsx("span",{className:"bg-white text-primary-600 text-xs px-2 py-1 rounded-full font-semibold",children:s?.doctor_Type})})]})]})}),e.jsxs("div",{className:"p-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(c,{icon:e.jsx(k,{className:"text-primary-500"}),label:"Total Patients",value:m?.length||0}),e.jsx(c,{icon:e.jsx(I,{className:"text-primary-500"}),label:"Consultation Fee",value:`Rs. ${s?.doctor_Fee||"N/A"}`}),e.jsx(c,{icon:e.jsx(P,{className:"text-green-500"}),label:"Joined On",value:new Date(s?.doctor_Contract?.doctor_JoiningDate).toLocaleDateString()||"N/A"}),e.jsx(c,{icon:e.jsx(F,{className:"text-purple-500"}),label:"License No.",value:s?.doctor_LicenseNumber||"N/A"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Patient Records"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 w-full",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(E,{className:"text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search patients...",className:"block w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:l,onChange:a=>j(a.target.value)})]}),e.jsxs("div",{className:"relative flex-1 md:flex-none md:w-48",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(M,{className:"text-gray-400"})}),e.jsxs("select",{className:"block w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:d,onChange:a=>f(a.target.value),children:[e.jsx("option",{value:"all",children:"All Patients"}),e.jsx("option",{value:"recent",children:"Recent (Last 7 days)"})]})]}),e.jsx("div",{className:"flex-1 md:flex-none md:w-auto",children:e.jsx(B,{startDate:r.start,endDate:r.end,onChange:a=>{g(a)},className:"w-full",showQuickOptions:!1})})]})]})})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"MR No"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Age/DOB"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Guardian"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Checkup Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.length>0?h.map(a=>e.jsx(G,{patient:a,navigate:i},a._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No patients found"})})})]})})]})]})},G=({patient:t,navigate:i})=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"shrink-0 h-10 w-10",children:e.jsx("img",{src:`https://api.dicebear.com/6.x/avataaars/svg?seed=${encodeURIComponent(t.patient_MRNo||t.patient_Name||"User")}`,alt:t.patient_Name,className:"h-10 w-10 rounded-full object-cover"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.patient_Name}),e.jsx("div",{className:"text-xs text-gray-500",children:t.patient_HospitalInformation?.doctor_Name})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-primary-600",children:t.patient_MRNo})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.patient_Age}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(t.patient_DateOfBirth).toLocaleDateString()})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.patient_Guardian?.guardian_Name}),e.jsx("div",{className:"text-xs text-gray-500",children:t.patient_Guardian?.guardian_Relation})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.patient_ContactNo||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.createdAt?e.jsxs(e.Fragment,{children:[new Date(t.createdAt).toLocaleDateString("en-CA")," ",e.jsx("br",{}),new Date(t.createdAt).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"Asia/Karachi"})]}):"N/A"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium flex space-x-1",children:[e.jsx("button",{type:"button",onClick:()=>i(U(`patient-records/${t._id}`)),className:"text-primary-600 p-1 rounded-md border border-primary-300 hover:bg-primary-50 hover:text-primary-700 transition-colors duration-200",title:"View patient","aria-label":"View patient",children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx("button",{className:"text-edit-600 p-1 rounded-md border border-edit-300 hover:bg-edit-50 hover:text-edit-700 transition-colors duration-200",title:"Edit doctor","aria-label":"Edit doctor",children:e.jsx($,{className:"h-4 w-4"})})]})]}),c=({icon:t,label:i,value:r})=>e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-white shadow-sm mr-3",children:t}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:i}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:r})]})]})});export{Z as default};
