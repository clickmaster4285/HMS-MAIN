import{j as t,r as T,t as X,f as tt,u as et,bI as st,cg as B}from"./index-D_CM1r6M.js";import{R as at}from"./server.browser-DuO4EFVg.js";import{f as p,b as z}from"./format-C6WB0tTj.js";import{p as y}from"./parseISO-4cjP3mE1.js";import{B as I,c as ot,d as nt,e as rt,a as i,f as it,A as lt,b as dt}from"./TableRow-Dkc_eAzu.js";import{d as u,I as P,P as ct,E as b,k as pt,q as xt,r as mt,C as ht}from"./TextField-Dd-glxQI.js";import{S as gt,T as W,P as ut,R as yt,L as ft,F as jt,M as St,C as Ct}from"./Tooltip-C9MxkRZY.js";import{g as vt,a as At,c as C,u as Mt,s as f,b as L,d as Dt,m as Tt}from"./createSvgIcon-ZRCmSFVj.js";import{A as wt}from"./index-DChziZlZ.js";import{m as Nt}from"./proxy-DAScg_hi.js";import{R as It,C as bt}from"./CalendarToday-C6rnxPf1.js";import"./assertThisInitialized-CHywsmAZ.js";import"./emotion-element-f0de968e.browser.esm-D488Ioqx.js";import"./index-DzhyyO-l.js";import"./Popper-OZxyrAG8.js";import"./index-Rj29YxKv.js";function Pt(e){return At("MuiAlert",e)}const _=vt("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),Lt=C(t.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"})),Rt=C(t.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"})),kt=C(t.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),Bt=C(t.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"})),zt=C(t.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})),Wt=e=>{const{variant:n,color:r,severity:o,classes:a}=e,l={root:["root",`color${L(r||o)}`,`${n}${L(r||o)}`,`${n}`],icon:["icon"],message:["message"],action:["action"]};return Dt(l,Pt,a)},_t=f(ct,{name:"MuiAlert",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:r}=e;return[n.root,n[r.variant],n[`${r.variant}${L(r.color||r.severity)}`]]}})(Tt(({theme:e})=>{const n=e.palette.mode==="light"?e.darken:e.lighten,r=e.palette.mode==="light"?e.lighten:e.darken;return{...e.typography.body2,backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(e.palette).filter(b(["light"])).map(([o])=>({props:{colorSeverity:o,variant:"standard"},style:{color:e.vars?e.vars.palette.Alert[`${o}Color`]:n(e.palette[o].light,.6),backgroundColor:e.vars?e.vars.palette.Alert[`${o}StandardBg`]:r(e.palette[o].light,.9),[`& .${_.icon}`]:e.vars?{color:e.vars.palette.Alert[`${o}IconColor`]}:{color:e.palette[o].main}}})),...Object.entries(e.palette).filter(b(["light"])).map(([o])=>({props:{colorSeverity:o,variant:"outlined"},style:{color:e.vars?e.vars.palette.Alert[`${o}Color`]:n(e.palette[o].light,.6),border:`1px solid ${(e.vars||e).palette[o].light}`,[`& .${_.icon}`]:e.vars?{color:e.vars.palette.Alert[`${o}IconColor`]}:{color:e.palette[o].main}}})),...Object.entries(e.palette).filter(b(["dark"])).map(([o])=>({props:{colorSeverity:o,variant:"filled"},style:{fontWeight:e.typography.fontWeightMedium,...e.vars?{color:e.vars.palette.Alert[`${o}FilledColor`],backgroundColor:e.vars.palette.Alert[`${o}FilledBg`]}:{backgroundColor:e.palette.mode==="dark"?e.palette[o].dark:e.palette[o].main,color:e.palette.getContrastText(e.palette[o].main)}}}))]}})),$t=f("div",{name:"MuiAlert",slot:"Icon"})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),Ot=f("div",{name:"MuiAlert",slot:"Message"})({padding:"8px 0",minWidth:0,overflow:"auto"}),Et=f("div",{name:"MuiAlert",slot:"Action"})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),$={success:t.jsx(Lt,{fontSize:"inherit"}),warning:t.jsx(Rt,{fontSize:"inherit"}),error:t.jsx(kt,{fontSize:"inherit"}),info:t.jsx(Bt,{fontSize:"inherit"})},O=T.forwardRef(function(n,r){const o=Mt({props:n,name:"MuiAlert"}),{action:a,children:l,className:v,closeText:x="Close",color:m,components:c={},componentsProps:w={},icon:j,iconMapping:S=$,onClose:A,role:N="alert",severity:s="success",slotProps:d={},slots:M={},variant:E="standard",...F}=o,h={...o,color:m,severity:s,variant:E,colorSeverity:m||s},D=Wt(h),g={slots:{closeButton:c.CloseButton,closeIcon:c.CloseIcon,...M},slotProps:{...w,...d}},[H,U]=u("root",{ref:r,shouldForwardComponentProp:!0,className:X(D.root,v),elementType:_t,externalForwardedProps:{...g,...F},ownerState:h,additionalProps:{role:N,elevation:0}}),[V,G]=u("icon",{className:D.icon,elementType:$t,externalForwardedProps:g,ownerState:h}),[Z,q]=u("message",{className:D.message,elementType:Ot,externalForwardedProps:g,ownerState:h}),[R,k]=u("action",{className:D.action,elementType:Et,externalForwardedProps:g,ownerState:h}),[Y,J]=u("closeButton",{elementType:P,externalForwardedProps:g,ownerState:h}),[K,Q]=u("closeIcon",{elementType:zt,externalForwardedProps:g,ownerState:h});return t.jsxs(H,{...U,children:[j!==!1?t.jsx(V,{...G,children:j||S[s]||$[s]}):null,t.jsx(Z,{...q,children:l}),a!=null?t.jsx(R,{...k,children:a}):null,a==null&&A?t.jsx(R,{...k,children:t.jsx(Y,{size:"small","aria-label":x,title:x,color:"inherit",onClick:A,...J,children:t.jsx(K,{fontSize:"small",...Q})})}):null]})}),Ft=({bills:e,dateRange:n})=>{const r=a=>{try{return p(y(a),"MMM dd, yyyy hh:mm a")}catch{return a}},o=a=>a.selectedTests&&Array.isArray(a.selectedTests)?a.selectedTests.map(l=>l.testDetails?.testName||l.testDetails?.testCode||"Unknown Test").join(", "):a.templateName?a.templateName:"No tests";return t.jsxs("div",{className:"print-container",style:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",maxWidth:"1000px",margin:"0 auto",padding:"30px",color:"#333",backgroundColor:"#fff",lineHeight:1.5},children:[t.jsxs("div",{className:"header",style:{textAlign:"center",marginBottom:"30px",paddingBottom:"20px",borderBottom:"2px solid #005792"},children:[t.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"10px"},children:[t.jsx("div",{style:{width:"60px",height:"60px",backgroundColor:"#005792",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"15px",color:"white",fontWeight:"bold",fontSize:"24px"},children:"SMDC"}),t.jsxs("div",{children:[t.jsx("div",{className:"hospital-name",style:{fontSize:"24px",fontWeight:"bold",color:"#005792",marginBottom:"5px",letterSpacing:"1px"},children:"AL-SHAHBAZ MODERN DIAGNOSTIC CENTER"}),t.jsx("div",{className:"hospital-subtitle",style:{fontSize:"16px",color:"#555",textTransform:"uppercase",letterSpacing:"1px"},children:"Laboratory Department"})]})]}),t.jsx("div",{style:{marginTop:"20px",fontSize:"18px",fontWeight:"600",color:"#005792"},children:"Lab Bill Summary"}),n&&t.jsxs("div",{className:"date-range",style:{fontSize:"14px",color:"#666",marginTop:"10px",backgroundColor:"#f5f9ff",padding:"8px 15px",display:"inline-block",borderRadius:"4px"},children:[t.jsx("span",{style:{fontWeight:"600"},children:"Period:"})," ",n.startDate&&r(n.startDate),n.endDate&&` - ${r(n.endDate)}`]})]}),t.jsxs("table",{className:"summary-table",style:{width:"100%",borderCollapse:"collapse",marginBottom:"30px",fontSize:"14px"},children:[t.jsx("thead",{children:t.jsxs("tr",{style:{backgroundColor:"#005792",color:"white",textTransform:"uppercase",letterSpacing:"0.5px"},children:[t.jsx("th",{style:{padding:"12px 10px",textAlign:"left",fontWeight:"600",width:"5%"},children:"#"}),t.jsx("th",{style:{padding:"12px 10px",textAlign:"left",fontWeight:"600",width:"10%"},children:"MR No."}),t.jsx("th",{style:{padding:"12px 10px",textAlign:"left",fontWeight:"600",width:"20%"},children:"Patient"}),t.jsx("th",{style:{padding:"12px 10px",textAlign:"left",fontWeight:"600",width:"30%"},children:"Tests"}),t.jsx("th",{style:{padding:"12px 10px",textAlign:"left",fontWeight:"600",width:"15%"},children:"Total Amount"}),t.jsx("th",{style:{padding:"12px 10px",textAlign:"left",fontWeight:"600",width:"10%"},children:"Status"}),t.jsx("th",{style:{padding:"12px 10px",textAlign:"left",fontWeight:"600",width:"20%"},children:"Date"})]})}),t.jsx("tbody",{children:e.map((a,l)=>t.jsxs("tr",{style:{borderBottom:"1px solid #e0e6ed",backgroundColor:l%2===0?"#f8fafc":"transparent"},children:[t.jsx("td",{style:{padding:"12px 10px",color:"#666"},children:l+1}),t.jsx("td",{style:{padding:"12px 10px",fontWeight:"500"},children:a.patientMRNO||a.patient_Detail?.patient_MRNo||"N/A"}),t.jsxs("td",{style:{padding:"12px 10px"},children:[t.jsx("div",{style:{fontWeight:"600",color:"#005792",marginBottom:"4px"},children:a.patientName||a.patient_Detail?.patient_Name||"Unknown"}),t.jsx("div",{style:{color:"#666",fontSize:"0.85em"},children:a.sex||a.patient_Detail?.patient_Gender||"N/A"})]}),t.jsx("td",{style:{padding:"12px 10px"},children:t.jsx("div",{style:{fontWeight:"500"},children:o(a)})}),t.jsxs("td",{style:{padding:"12px 10px",color:"#444"},children:["Rs. ",(a.totalAmount||0).toLocaleString()]}),t.jsx("td",{style:{padding:"12px 10px",color:a.paymentStatus==="Paid"||a.paymentStatus==="paid"?"#2f855a":"#b7791f",fontWeight:"bold"},children:a.paymentStatus}),t.jsx("td",{style:{padding:"12px 10px",color:"#555",fontSize:"0.9em"},children:r(a.date||a.createdAt)})]},a._id))})]}),t.jsxs("div",{className:"footer",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"40px",paddingTop:"20px",borderTop:"1px solid #e0e6ed",color:"#666",fontSize:"14px"},children:[t.jsxs("div",{className:"contact-info",style:{display:"flex",flexDirection:"column",gap:"4px"},children:[t.jsx("div",{children:"Phone: +123 456 7890"}),t.jsx("div",{children:"Email: info@alshahbazdiagnostic.com"}),t.jsx("div",{children:"Address: 123 Medical St, Health City"})]}),t.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"8px"},children:[t.jsxs("div",{className:"timestamp",children:[t.jsx("span",{style:{fontWeight:"600"},children:"Printed on:"})," ",r(new Date().toISOString())]}),t.jsxs("div",{className:"total",style:{fontWeight:"bold",color:"#005792",fontSize:"16px",backgroundColor:"#f0f7ff",padding:"8px 15px",borderRadius:"4px"},children:["Total Bills: ",e.length]})]})]})]})},Ht=f(Ct)(()=>({background:"rgba(255, 255, 255, 0.9)",backdropFilter:"blur(10px)",borderRadius:"16px",border:"1px solid rgba(0, 150, 137, 0.2)",boxShadow:"0 8px 32px rgba(0, 150, 137, 0.15)"})),Ut=f(dt)(()=>({background:"transparent",borderRadius:"12px",overflow:"hidden"})),ie=()=>{const e=tt(),{labBillSummary:n,status:r,error:o}=et(s=>s.labBill),[a,l]=T.useState(""),[v]=st(),x=v.get("startDate"),m=v.get("endDate"),[c,w]=T.useState({startDate:null,endDate:null});T.useEffect(()=>{let s,d;const M=new Date;x&&z(y(x))?(s=y(x),d=m&&z(y(m))?y(m):s):(s=M,d=M),w({startDate:s,endDate:d}),e(B({startDate:p(s,"yyyy-MM-dd"),endDate:p(d,"yyyy-MM-dd")}))},[e,x,m]);const j=s=>s.selectedTests&&Array.isArray(s.selectedTests)?s.selectedTests.map(d=>d.testDetails?.testName||d.testDetails?.testCode||"Unknown Test").join(", "):s.templateName?s.templateName:"No tests",S=n?.filter(s=>s.patientName?.toLowerCase().includes(a.toLowerCase())||s.patient_Detail?.patient_Name?.toLowerCase().includes(a.toLowerCase())||s.patientMRNO?.toLowerCase().includes(a.toLowerCase())||s.patient_Detail?.patient_MRNo?.toLowerCase().includes(a.toLowerCase())||j(s)?.toLowerCase().includes(a.toLowerCase())),A=s=>{try{return p(y(s),"MMM dd, yyyy hh:mm a")}catch{return s||"Invalid Date"}},N=()=>{const s=window.open("","_blank");if(!s)return alert("Please allow popups for printing");const d=at.renderToString(t.jsx(Ft,{bills:S,dateRange:{startDate:c.startDate?p(c.startDate,"yyyy-MM-dd"):null,endDate:c.endDate?p(c.endDate,"yyyy-MM-dd"):null}}));s.document.write(`
      <!DOCTYPE html><html><head><title>Lab Bill Summary</title></head>
      <body>${d}</body></html>
    `),s.document.close(),s.focus(),s.print()};return t.jsxs(I,{sx:{p:3},children:[t.jsxs(I,{sx:{display:"flex",justifyContent:"space-between",mb:3},children:[t.jsx(pt,{variant:"h5",sx:{fontWeight:"bold",color:"#009689"},children:"Lab Bill Summary"}),t.jsxs(I,{sx:{display:"flex",gap:2},children:[t.jsx(xt,{placeholder:"Search by name, MR No, or test",value:a,onChange:s=>l(s.target.value),InputProps:{startAdornment:t.jsx(mt,{position:"start",children:t.jsx(gt,{sx:{color:"#009689"}})})},sx:{minWidth:300}}),t.jsx(W,{title:"Print Summary",children:t.jsx(P,{onClick:N,sx:{color:"#009689"},children:t.jsx(ut,{})})}),t.jsx(W,{title:"Refresh Data",children:t.jsx(P,{onClick:()=>e(B({startDate:p(c.startDate,"yyyy-MM-dd"),endDate:p(c.endDate,"yyyy-MM-dd")})),sx:{color:"#009689"},children:t.jsx(yt,{})})})]})]}),r==="loading"&&t.jsx(ft,{sx:{mb:2}}),o&&t.jsx(O,{severity:"error",sx:{mb:2},children:o}),S?.length===0&&r!=="loading"&&t.jsx(O,{severity:"info",sx:{mb:2},children:"No bills found for the selected date range."}),t.jsx(Ht,{children:t.jsx(Ut,{children:t.jsxs(ot,{children:[t.jsx(nt,{children:t.jsxs(rt,{children:[t.jsx(i,{children:"MR No."}),t.jsx(i,{children:"Patient"}),t.jsx(i,{children:"Tests"}),t.jsx(i,{children:"Total"}),t.jsx(i,{children:"Status"}),t.jsx(i,{children:"Date"})]})}),t.jsx(it,{children:t.jsx(wt,{children:S?.map(s=>t.jsxs(Nt.tr,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[t.jsx(i,{children:s.patientMRNO||s.patient_Detail?.patient_MRNo||"N/A"}),t.jsxs(i,{children:[t.jsx(lt,{sx:{mr:1,bgcolor:"#009689"},children:(s.sex||s.patient_Detail?.patient_Gender)==="Female"?t.jsx(jt,{}):t.jsx(St,{})}),s.patientName||s.patient_Detail?.patient_Name||"Unknown"]}),t.jsxs(i,{children:[t.jsx(It,{sx:{mr:1,color:"#009689"}}),j(s)]}),t.jsxs(i,{children:["Rs. ",(s.totalAmount||0).toLocaleString()]}),t.jsx(i,{children:t.jsx(ht,{label:s.paymentStatus||"Unknown",size:"small",color:s.paymentStatus==="Paid"||s.paymentStatus==="paid"?"success":"warning"})}),t.jsxs(i,{children:[t.jsx(bt,{sx:{mr:1,color:"#009689"}}),A(s.date||s.createdAt)]})]},s._id))})})]})})})]})};export{ie as default};
