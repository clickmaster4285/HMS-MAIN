import{j as e,f as k,d as I,u as j,bd as R,r as i,X as T,a6 as P,h as D,a8 as F,a9 as M}from"./index-D_CM1r6M.js";import{m as H,n as A,o as $}from"./index-CVhLpNpZ.js";import{d as O}from"./index-C4dsM683.js";import{D as E,P as L}from"./DeletePatientConfirmation-C-n4Xl_C.js";import{a1 as B,i as V,a6 as W,D as Q}from"./index-jLjFIv2f.js";import{g as z}from"./getRoleRoute-Do-Qfut4.js";import"./iconBase-DSUUJbys.js";const y=({title:r,value:p,icon:d,bgColor:n,textColor:u})=>e.jsx("div",{className:`p-4 rounded-lg shadow-md ${n} ${u}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:r}),e.jsx("p",{className:"text-2xl font-bold mt-1",children:p})]}),e.jsx("div",{className:"text-3xl",children:d})]})}),U=({patients:r})=>{const p=r.length,d=r.reduce((o,c)=>o+(c.patient_HospitalInformation?.doctor_Fee||0),0),n=r.reduce((o,c)=>o+(c.patient_HospitalInformation?.discount||0),0),u=r.reduce((o,c)=>o+(c.patient_HospitalInformation?.total_Fee||0),0);return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx(y,{title:"Total Patients",value:p,icon:e.jsx(B,{}),bgColor:"bg-primary-100",textColor:"text-primary-800"}),e.jsx(y,{title:"Total Doctor Fee",value:`Rs. ${d.toLocaleString()}`,icon:e.jsx(V,{}),bgColor:"bg-green-100",textColor:"text-green-800"}),e.jsx(y,{title:"Total Discount",value:`Rs. ${n.toLocaleString()}`,icon:e.jsx(W,{}),bgColor:"bg-yellow-100",textColor:"text-yellow-800"}),e.jsx(y,{title:"Total Revenue",value:`Rs. ${u.toLocaleString()}`,icon:e.jsx(Q,{}),bgColor:"bg-purple-100",textColor:"text-purple-800"})]})},ae=()=>{const r=k(),p=I(),d=j(R),[n,u]=i.useState(""),o=j(T),c=j(P),[S,w]=i.useState(!1),[X,Y]=i.useState(null),[a,h]=i.useState(()=>{const t=new Date().toISOString().split("T")[0];return{start:t,end:t}});i.useEffect(()=>{r(D()).unwrap().catch(t=>{console.error("Error fetching all patients:",t)})},[r]);const[N,b]=i.useState(null),_=()=>{w(!1),r(F())},C=async t=>{await r(M(t)),w(!0)};i.useEffect(()=>{r(D())},[r]);const x=i.useMemo(()=>(d||[]).slice().reverse().filter(t=>{if(!t)return!1;const g=(t.patient_Name||"").toLowerCase().includes(n.toLowerCase())||(t.patient_MRNo||"").includes(n);let m=!0;if(a.start||a.end)try{const s=new Date(t.createdAt);if(isNaN(s.getTime()))return!1;if(a.start&&!a.end){const l=new Date(a.start);m=s>=l}else if(!a.start&&a.end){const l=new Date(a.end);l.setHours(23,59,59),m=s<=l}else if(a.start&&a.end){const l=new Date(a.start),f=new Date(a.end);f.setHours(23,59,59),m=s>=l&&s<=f}}catch(s){return console.error("Invalid date format",s),!1}return g&&m})||[],[d,n,a]),v=(t,g)=>{h(m=>{const s={...m,[t]:g};if(s.start&&s.end){const l=new Date(s.start),f=new Date(s.end);if(l>f)return{start:s.end,end:s.start}}return s})};return e.jsxs("div",{className:"",children:[N&&e.jsx(E,{patient:N,onClose:()=>b(null)}),S&&e.jsx(L,{patient:o,loading:c==="loading",onClose:_}),e.jsxs("div",{className:"max-w-8xl mx-auto bg-white rounded-xl shadow-md overflow-hidden",children:[e.jsx("div",{className:"bg-primary-600 p-4 md:p-6 text-white",children:e.jsxs("div",{className:"flex flex-col xl:flex-row  justify-between items-start space-y-4 xl:space-y-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-14 w-1 bg-primary-300 mr-4 rounded-full"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"OPD Billing"}),e.jsx("p",{className:"text-primary-100 mt-1",children:"View and manage outpatient department records billing details"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-4 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:w-64",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(O,{className:"text-gray-400"})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Search by name or MR#",value:n,onChange:t=>u(t.target.value)})]}),e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"date",className:"block w-full pl-3 pr-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-primary-500",value:a.start,onChange:t=>v("start",t.target.value),placeholder:"Start date",max:a.end}),e.jsx("input",{type:"date",className:"block w-full pl-3 pr-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-primary-500",value:a.end,onChange:t=>v("end",t.target.value),placeholder:"End date",min:a.start})]}),e.jsxs("div",{className:"grid items-center grid-cols-2 gap-1",children:[e.jsx("button",{onClick:()=>{const t=new Date().toISOString().split("T")[0];h({start:t,end:t})},className:"text-xs text-primary-900 px-2 py-0.5 bg-primary-100 rounded hover:bg-primary-200",children:"Today"}),e.jsx("button",{onClick:()=>{const t=new Date,g=new Date(t.setDate(t.getDate()-t.getDay()));h({start:g.toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]})},className:"text-xs px-2 text-primary-900 py-0.5 bg-primary-100 rounded hover:bg-primary-200",children:"This Week"}),e.jsx("button",{onClick:()=>{const t=new Date;h({start:new Date(t.getFullYear(),t.getMonth(),1).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]})},className:"col-span-2 text-xs px-2 text-primary-900 py-0.5 bg-primary-100 rounded hover:bg-primary-200",children:"This Month"})]})]})]})]})}),e.jsx("div",{className:"px-4 md:px-6 pt-4",children:e.jsx(U,{patients:x})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Token"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"MR#"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Doctor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Doctor Fee"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Discount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.length>0?x.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-primary-100 text-primary-800",children:t.patient_HospitalInformation?.token||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.patient_MRNo}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-base font-normal text-gray-900",children:t.patient_Name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.patient_HospitalInformation?.doctor_Name||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.patient_HospitalInformation?.doctor_Department||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.patient_HospitalInformation?.doctor_Fee?`Rs. ${t.patient_HospitalInformation.doctor_Fee}`:"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.patient_HospitalInformation?.discount?`Rs. ${t.patient_HospitalInformation.discount}`:"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.patient_HospitalInformation?.total_Fee?`Rs. ${t.patient_HospitalInformation.total_Fee}`:"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>C(t._id),className:"text-primary-600 border border-primary-200 hover:text-primary-900 p-1 rounded-md hover:bg-primary-50","aria-label":`View ${t.patient_Name}`,children:e.jsx(H,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>p(z(`opd/edit/${t.patient_MRNo}`)),className:"text-yellow-600 border border-yellow-200 hover:text-yellow-900 p-1 rounded-md hover:bg-yellow-50","aria-label":`Edit ${t.patient_Name}`,children:e.jsx(A,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>b(t),className:"text-red-600 border border-red-200 hover:text-red-900 p-1 rounded-md hover:bg-red-50","aria-label":`Delete ${t.patient_Name}`,children:e.jsx($,{className:"h-5 w-5"})})]})})]},t._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"mt-2 font-medium text-gray-600",children:"No patients found"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Try adjusting your search or date filter"})]})})})})]})}),x.length>0&&e.jsx("div",{className:"bg-gray-50  border rounded-xs border-t-gray-300 px-6 py-3 flex items-center justify-center  border-primary-400",children:e.jsxs("div",{className:"text-sm text-gray-500 ",children:["Showing ",e.jsx("span",{className:"font-medium",children:x.length})," of"," ",e.jsx("span",{className:"font-medium",children:x.length})," results"]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between justify-center sm:items-start sitems-center gap-2 px-6 py-3 bg-gray-50 border-t border-gray-200",children:[a.start&&a.end&&e.jsxs("div",{className:"text-sm px-3 py-1.5 rounded-md bg-primary-600 text-white",children:["Showing patients between ",e.jsx("span",{className:"font-medium",children:new Date(a.start).toLocaleDateString()})," and ",e.jsx("span",{className:"font-medium",children:new Date(a.end).toLocaleDateString()})]}),(a.start||a.end)&&e.jsx("button",{onClick:()=>h({start:"",end:""}),className:"inline-flex  items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Reset All Filters"})]})]})]})};export{ae as default};
